<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
<title>Valentine</title>

<style>
html,body{
  margin:0;
  height:100%;
  background:#111;
  font-family:system-ui;
  overflow:hidden;
}

.app{
  position:relative;
  width:100vw;
  height:100vh;
  overflow:hidden;
}

/* ================= BACKGROUND ================= */
.bg{
  position:absolute;
  inset:0;
  background: radial-gradient(circle at 50% 20%, #ffe6f0, #e6a9c8 60%, #b983a6);
  animation: glow 6s ease-in-out infinite alternate;
}
@keyframes glow{
  from{filter:brightness(1)}
  to{filter:brightness(1.15)}
}

/* ================= CANVAS FIX ================= */
canvas{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  pointer-events:none; /* ‚≠ê supaya bisa klik layer */
}

/* ================= LAYER ================= */
.layer{
  position:absolute;
  inset:0;
  z-index:2;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  text-align:center;
  color:white;
  padding:20px;
}

/* ================= FOTO ================= */
.circle{
  width:min(75vw,320px);
  height:min(75vw,320px);
  border-radius:50%;
  overflow:hidden;
  border:5px solid rgba(255,255,255,.8);
  box-shadow:0 0 40px rgba(255,150,200,.7);
  transition:opacity 1s;
}

.circle img{
  width:100%;
  height:100%;
  object-fit:cover;
}

/* ================= PANEL ================= */
.panel{
  position:absolute;
  bottom:0;
  left:0;
  right:0;
  padding:20px;
  background:rgba(0,0,0,.55);
  backdrop-filter:blur(8px);
  max-height:45vh;
  overflow-y:auto;
}

.text{
  font-size:15px;
  line-height:1.7;
  white-space:pre-wrap;
}

/* ================= FLOWER FIX ================= */
.flower{
  position:relative;
  width:220px;
  height:220px;
}

.petal{
  position:absolute;
  width:60px;
  height:24px;
  border-radius:50%;
  background:linear-gradient(135deg,#ff9fc4,#ffd7ea);
  left:50%;
  top:50%;
  transform-origin:center;
  transition:transform .6s ease;
}

.center{
  position:absolute;
  top:50%;left:50%;
  width:40px;height:40px;
  border-radius:50%;
  background:#ffe3a3;
  transform:translate(-50%,-50%);
}
</style>
</head>

<body>

<div class="app">
<div class="bg"></div>
<canvas id="fx"></canvas>

<div class="layer" id="opening">
  <h2>From me ‚Üí For you ü§ç</h2>
  <small>Tap layar untuk mulai</small>
</div>

<div class="layer" id="slide" style="display:none">
  <div class="circle">
    <img id="photo" src="foto1.jpg">
  </div>
  <div class="panel">
    <div id="typed" class="text"></div>
  </div>
</div>

<div class="layer" id="closing" style="display:none">
  <div id="flower" class="flower"></div>
  <h3>Still with you, always ü§ç</h3>
</div>

<audio id="music" src="lagu.mp3" loop playsinline></audio>
</div>

<script>
/* ================= CANVAS EFFECT ================= */
const canvas=document.getElementById("fx");
const ctx=canvas.getContext("2d");

function resize(){
  canvas.width=innerWidth;
  canvas.height=innerHeight;
}
resize();
addEventListener("resize",resize);

const hearts=Array.from({length:35},()=>({
 x:Math.random()*canvas.width,
 y:Math.random()*canvas.height,
 s:Math.random()*1+.4
}));

function draw(){
 ctx.clearRect(0,0,canvas.width,canvas.height);

 hearts.forEach(h=>{
  h.y-=h.s;
  if(h.y<0) h.y=canvas.height;
  ctx.fillStyle="#ffc2da";
  ctx.beginPath();
  ctx.arc(h.x,h.y,3,0,Math.PI*2);
  ctx.fill();
 });

 requestAnimationFrame(draw);
}
draw();

/* ================= SLIDESHOW ================= */
const photos=["foto1.jpg","foto2.jpg","foto3.jpg","foto4.jpg","foto5.jpg"];

const text=`first, terima kasih ya sayang sudah menemani setiap suka-duka kehidupan aku...
still with you, always ü§ç`;

const photo=document.getElementById("photo");
const typed=document.getElementById("typed");
const music=document.getElementById("music");
const opening=document.getElementById("opening");
const slide=document.getElementById("slide");
const closing=document.getElementById("closing");

let idx=0;

/* FOTO */
function nextPhoto(){
 photo.style.opacity=0;
 setTimeout(()=>{
   photo.src=photos[idx%photos.length];
   photo.style.opacity=1;
   idx++;
 },500);
}
setInterval(nextPhoto,6000);

/* TEXT */
function typeText(){
 let i=0;
 typed.textContent="";
 const iv=setInterval(()=>{
   typed.textContent+=text[i++]||"";
   typed.scrollTop=typed.scrollHeight;
   if(i>=text.length) clearInterval(iv);
 },18);
}

/* FLOWER RAPI */
function buildFlower(){
 const f=document.getElementById("flower");
 const n=10, r=75;

 for(let i=0;i<n;i++){
  const p=document.createElement("div");
  p.className="petal";
  const a=(360/n)*i*Math.PI/180;
  const x=Math.cos(a)*r;
  const y=Math.sin(a)*r;
  p.style.transform=`translate(${x}px,${y}px) scale(0)`;
  f.appendChild(p);

  setTimeout(()=>p.style.transform=`translate(${x}px,${y}px) scale(1)`,i*120);
 }

 const c=document.createElement("div");
 c.className="center";
 f.appendChild(c);
}

/* AUDIO */
function fadeMusic(){
 music.volume=0;
 music.play();
 const iv=setInterval(()=>{
   music.volume+=0.05;
   if(music.volume>=1) clearInterval(iv);
 },200);
}

/* START (HP + Chrome SAFE) */
function start(){
 opening.style.display="none";
 slide.style.display="flex";
 fadeMusic();
 typeText();

 setTimeout(()=>{
   slide.style.display="none";
   closing.style.display="flex";
   buildFlower();
 },83000); /* ‚≠ê 1 menit 23 detik */
}

opening.addEventListener("click",start,{once:true});
opening.addEventListener("touchstart",start,{once:true});
</script>

</body>
</html>

