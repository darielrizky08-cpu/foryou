<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>

<title>Valentine</title>

<style>
html,body{
  margin:0;
  height:100%;
  background:#111;
  font-family:system-ui;
  overflow:hidden;
}

.app{
  position:relative;
  width:100vw;
  height:100vh;
}

/* ================= BG ================= */
.bg{
  position:absolute;
  inset:0;
  background: radial-gradient(circle at 50% 20%, #ffe6f0, #e6a9c8 60%, #b983a6);
}

/* ‚≠ê penting: klik tembus */
canvas{
  position:absolute;
  inset:0;
  pointer-events:none;
}

/* ================= LAYER ================= */
.layer{
  position:absolute;
  inset:0;
  z-index:2;
  display:flex;
  justify-content:center;
  align-items:center;
  flex-direction:column;
  text-align:center;
  color:white;
  padding:20px;
}

/* ================= FOTO ================= */
.circle{
  width:min(75vw,300px);
  height:min(75vw,300px);
  border-radius:50%;
  overflow:hidden;
  border:5px solid white;
}

.circle img{
  width:100%;
  height:100%;
  object-fit:cover;
  transition:opacity .8s;
}

/* ================= PANEL ================= */
.panel{
  position:absolute;
  bottom:0;
  left:0;
  right:0;
  background:rgba(0,0,0,.6);
  padding:18px;
  max-height:45vh;
  overflow:auto;
}

.text{
  font-size:14px;
  line-height:1.6;
  white-space:pre-wrap;
}

/* ================= FLOWER ================= */
.flower{
  position:relative;
  width:220px;
  height:220px;
}

.petal{
  position:absolute;
  width:60px;
  height:24px;
  border-radius:50%;
  background:linear-gradient(135deg,#ff9fc4,#ffd7ea);
  left:50%;
  top:50%;
  transform-origin:center;
  transition:transform .6s ease;
}

.center{
  position:absolute;
  width:40px;
  height:40px;
  border-radius:50%;
  background:#ffe3a3;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
}
</style>
</head>

<body>

<div class="app">
<div class="bg"></div>
<canvas id="fx"></canvas>

<!-- OPENING -->
<div class="layer" id="opening">
  <h2>Tap untuk mulai ü§ç</h2>
</div>

<!-- SLIDE -->
<div class="layer" id="slide" style="display:none">
  <div class="circle">
    <img id="photo" src="foto1.jpg">
  </div>

  <div class="panel">
    <div id="typed" class="text"></div>
  </div>
</div>

<!-- CLOSING -->
<div class="layer" id="closing" style="display:none">
  <div id="flower" class="flower"></div>
  <h3>Still with you, always ü§ç</h3>
</div>

<!-- ‚≠ê preload audio biar HP cepat -->
<audio id="music" src="lagu.mp3" preload="auto" loop playsinline></audio>

</div>

<script>
/* ================= ELEMENT FIX ================= */
const canvas = document.getElementById("fx");
const ctx = canvas.getContext("2d");

const opening = document.getElementById("opening");
const slide = document.getElementById("slide");
const closing = document.getElementById("closing");

const photo = document.getElementById("photo");
const typed = document.getElementById("typed");
const music = document.getElementById("music");
const flower = document.getElementById("flower");

/* ================= CANVAS HEART ================= */
function resize(){
  canvas.width=innerWidth;
  canvas.height=innerHeight;
}
resize();
addEventListener("resize",resize);

const hearts = Array.from({length:30},()=>({
 x:Math.random()*canvas.width,
 y:Math.random()*canvas.height,
 s:Math.random()*1+0.5
}));

function draw(){
 ctx.clearRect(0,0,canvas.width,canvas.height);

 hearts.forEach(h=>{
  h.y-=h.s;
  if(h.y<0) h.y=canvas.height;
  ctx.fillStyle="#ffc2da";
  ctx.beginPath();
  ctx.arc(h.x,h.y,3,0,6.28);
  ctx.fill();
 });

 requestAnimationFrame(draw);
}
draw();

/* ================= SLIDES ================= */
const photos=["foto1.jpg","foto2.jpg","foto3.jpg","foto4.jpg","foto5.jpg"];

let p=0;

function nextPhoto(){
 photo.style.opacity=0;
 setTimeout(()=>{
   photo.src=photos[p%photos.length];
   photo.style.opacity=1;
   p++;
 },400);
}

setInterval(nextPhoto,6000);

/* ================= TEXT ================= */
const text=`first, terima kasih ya sayang sudah menemani setiap suka-duka kehidupan aku.
aku bersyukur semesta ngenalin aku ke kamu.

being with you taught me that love doesn't have to be loud.
sometimes it's quiet, warm, and steady.

still with you, always ü§ç`;

function typeText(){
 let i=0;
 typed.textContent="";
 const iv=setInterval(()=>{
   typed.textContent+=text[i++]||"";
   typed.scrollTop=typed.scrollHeight;
   if(i>=text.length) clearInterval(iv);
 },18);
}

/* ================= FLOWER ================= */
function buildFlower(){
 const n=10, r=75;

 for(let i=0;i<n;i++){
  const pet=document.createElement("div");
  pet.className="petal";

  const a=(360/n)*i*Math.PI/180;
  const x=Math.cos(a)*r;
  const y=Math.sin(a)*r;

  pet.style.transform=`translate(${x}px,${y}px) scale(0)`;
  flower.appendChild(pet);

  setTimeout(()=>{
   pet.style.transform=`translate(${x}px,${y}px) scale(1)`
  },i*120);
 }

 const c=document.createElement("div");
 c.className="center";
 flower.appendChild(c);
}

/* ================= START (HP SAFE) ================= */
function start(){

  /* ‚≠ê WAJIB pertama biar musik jalan di HP */
  music.muted=false;
  music.play().catch(()=>{});

  opening.style.display="none";
  slide.style.display="flex";

  typeText();

  /* ‚≠ê total 83 detik */
  setTimeout(()=>{
    slide.style.display="none";
    closing.style.display="flex";
    buildFlower();
  },83000);
}

opening.addEventListener("click",start,{once:true});
opening.addEventListener("touchstart",start,{once:true});
</script>

</body>
</html>
