<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
<title>Valentine</title>

<style>
html,body{
  margin:0;
  height:100%;
  background:#111;
  font-family:system-ui;
  overflow:hidden;
}

.app{
  position:relative;
  width:100vw;
  height:100vh;
  overflow:hidden;
}

/* BACKGROUND */
.bg{
  position:absolute;
  inset:0;
  background: radial-gradient(circle at 50% 20%, #ffe6f0, #e6a9c8 60%, #b983a6);
  animation: glow 6s ease-in-out infinite alternate;
}
@keyframes glow{
  from{filter:brightness(1)}
  to{filter:brightness(1.15)}
}

/* CANVAS */
canvas{
  position:absolute;
  inset:0;
  pointer-events:none; /* supaya tidak blok klik */
}

/* LAYER */
.layer{
  position:absolute;
  inset:0;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  text-align:center;
  color:white;
  padding:20px;
}

/* FOTO */
.circle{
  width:min(75vw,320px);
  height:min(75vw,320px);
  border-radius:50%;
  overflow:hidden;
  border:5px solid rgba(255,255,255,.8);
  box-shadow:0 0 40px rgba(255,150,200,.7);
}

.circle img{
  width:100%;
  height:100%;
  object-fit:cover;
}

/* PANEL */
.panel{
  position:absolute;
  bottom:0;
  left:0;
  right:0;
  padding:20px;
  background:rgba(0,0,0,.5);
  backdrop-filter:blur(8px);
  max-height:45vh;
  overflow-y:auto;
}

.text{
  font-size:15px;
  line-height:1.7;
  white-space:pre-wrap;
}
</style>
</head>

<body>

<div class="app">
<div class="bg"></div>
<canvas id="fx"></canvas>

<div class="layer" id="opening">
  <h2>From me ‚Üí For you ü§ç</h2>
  <small>Tap layar untuk mulai</small>
</div>

<div class="layer" id="slide" style="display:none">
  <div class="circle">
    <img id="photo" src="foto1.jpg">
  </div>
  <div class="panel">
    <div id="typed" class="text"></div>
  </div>
</div>

<!-- üî• AUDIO FIX (PRELOAD + SOURCE) -->
<audio id="music" preload="auto" loop>
  <source src="lagu.mp3" type="audio/mpeg">
</audio>

</div>

<script>
/* ======================
   CANVAS EFFECT
====================== */
const canvas = document.getElementById("fx");
const ctx = canvas.getContext("2d");

function resize(){
  canvas.width = innerWidth;
  canvas.height = innerHeight;
}
resize();
addEventListener("resize", resize);

const hearts = Array.from({length:40},()=>({
 x:Math.random()*canvas.width,
 y:Math.random()*canvas.height,
 s:Math.random()*1+0.4
}));

function draw(){
 ctx.clearRect(0,0,canvas.width,canvas.height);

 hearts.forEach(h=>{
  h.y-=h.s;
  if(h.y<0) h.y=canvas.height;
  ctx.fillStyle="#ffb6d5";
  ctx.fillRect(h.x,h.y,3,3);
 });

 requestAnimationFrame(draw);
}
draw();


/* ======================
   TEXT + MUSIC FIX HP
====================== */
const opening = document.getElementById("opening");
const slide   = document.getElementById("slide");
const typed   = document.getElementById("typed");
const music   = document.getElementById("music");

const text = `first, terima kasih ya sayang sudah menemani setiap suka-duka kehidupan aku.
lewat hal-hal kecil yang bahkan aku sendiri ga sadar, contohnya kaya ada kamu didalamnya.

being with you taught me that love doesn't have to be loud.
sometimes it's quiet, warm, and steady.

still with you, always ü§ç`;


/* üî• START FUNCTION (FIX MOBILE AUDIO) */
function start(e){

  e.preventDefault();

  opening.style.display="none";
  slide.style.display="flex";

  /* paksa play biar HP bunyi */
  music.currentTime = 0;
  music.muted = false;

  const p = music.play();
  if(p !== undefined){
    p.catch(()=>{});
  }

  /* efek ketik */
  let i=0;
  const iv=setInterval(()=>{
    typed.textContent+=text[i++]||"";
    if(i>=text.length) clearInterval(iv);
  },18);
}

/* penting: touchstart untuk HP */
opening.addEventListener("touchstart", start, {once:true});
opening.addEventListener("click", start, {once:true});
</script>

</body>
</html>
