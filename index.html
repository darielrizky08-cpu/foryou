<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>

<title>Valentine</title>

<style>
html,body{
  margin:0;
  height:100%;
  background:#111;
  font-family:system-ui;
  overflow:hidden;
}

.app{
  position:relative;
  width:100vw;
  height:100vh;
}

canvas{
  position:absolute;
  inset:0;
}

.layer{
  position:absolute;
  inset:0;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  text-align:center;
  color:#fff;
  padding:20px;
}

.bg{
  position:absolute;
  inset:0;
  background: radial-gradient(circle at 50% 20%, #ffe6f0, #e6a9c8 60%, #b983a6);
}

/* FOTO */
.circle{
  width:min(75vw,320px);
  height:min(75vw,320px);
  border-radius:50%;
  overflow:hidden;
  border:5px solid rgba(255,255,255,.7);
}

.circle img{
  width:100%;
  height:100%;
  object-fit:cover;
}

.panel{
  position:absolute;
  bottom:0;
  left:0;
  right:0;
  padding:18px;
  background:linear-gradient(transparent, rgba(0,0,0,.65));
}

/* üå∏ BUNGA BARU (rapi & center) */
.flower{
  position:relative;
  width:220px;
  height:220px;
}

.petal{
  position:absolute;
  top:50%;
  left:50%;
  width:70px;
  height:26px;
  border-radius:50%;
  background:linear-gradient(135deg,#ff9fc4,#ffd7ea);
  transform-origin:0 50%;
  opacity:0;
  transition:.5s ease;
}

.center{
  position:absolute;
  top:50%;
  left:50%;
  width:40px;
  height:40px;
  background:#ffe3a3;
  border-radius:50%;
  transform:translate(-50%,-50%);
}
</style>
</head>

<body>
<div class="app">

<div class="bg"></div>
<canvas id="fx"></canvas>

<div class="layer" id="opening">
  <h2>From me ‚Üí For you ü§ç</h2>
  <small>Tap layar untuk mulai</small>
</div>

<div class="layer" id="slide" style="display:none">
  <div class="circle">
    <img id="photo" src="foto1.jpg">
  </div>
  <div class="panel">
    <div id="typed"></div>
  </div>
</div>

<div class="layer" id="closing" style="display:none">
  <div id="flower" class="flower"></div>
  <h3>Still with you, always ü§ç</h3>
</div>

<audio id="music" src="lagu.mp3" loop playsinline muted></audio>

</div>

<script>
/* =================
   CANVAS HEART
================= */
const canvas=document.getElementById('fx');
const ctx=canvas.getContext('2d');

function resize(){
  canvas.width=innerWidth;
  canvas.height=innerHeight;
}
resize();
addEventListener('resize',resize);

const hearts=Array.from({length:25},()=>({
  x:Math.random()*canvas.width,
  y:Math.random()*canvas.height,
  s:Math.random()*1+.5
}));

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  hearts.forEach(h=>{
    h.y-=h.s;
    if(h.y<0) h.y=canvas.height;
    ctx.beginPath();
    ctx.arc(h.x,h.y,3,0,Math.PI*2);
    ctx.fillStyle="#ffc2da";
    ctx.fill();
  });
  requestAnimationFrame(draw);
}
draw();

/* =================
   TIMING 1:23 MENIT
================= */
const TOTAL_TIME = 83000; // 83 detik
const photos=["foto1.jpg","foto2.jpg","foto3.jpg","foto4.jpg","foto5.jpg"];
const texts=[
"Terima kasih sudah selalu ada.",
"Aku bersyukur semesta ngenalin aku ke kamu.",
"Kamu selalu sabar dan hangat.",
"Love doesn't have to be loud.",
"Still with you, always."
];

const DURATION = TOTAL_TIME / photos.length;

const opening=document.getElementById('opening');
const slide=document.getElementById('slide');
const closing=document.getElementById('closing');
const photo=document.getElementById('photo');
const typed=document.getElementById('typed');
const music=document.getElementById('music');

let i=0;

function typeText(t){
 typed.textContent="";
 let k=0;
 const iv=setInterval(()=>{
   typed.textContent+=t[k++]||"";
   if(k>=t.length)clearInterval(iv);
 },18);
}

function next(){
 if(i>=photos.length){
   slide.style.display="none";
   closing.style.display="flex";
   buildFlower();
   return;
 }

 photo.src=photos[i];
 typeText(texts[i]);
 i++;
 setTimeout(next,DURATION);
}

/* =================
   FLOWER RAPI
================= */
function buildFlower(){
 const f=document.getElementById('flower');

 for(let j=0;j<10;j++){
   const p=document.createElement('div');
   p.className="petal";
   f.appendChild(p);

   const angle=(360/10)*j;

   setTimeout(()=>{
     p.style.opacity=1;
     p.style.transform=`rotate(${angle}deg) translateX(80px)`;
   },j*120);
 }

 const c=document.createElement('div');
 c.className="center";
 f.appendChild(c);
}

/* =================
   START
================= */
addEventListener('click',()=>{
  music.muted=false;
  music.play().catch(()=>{});
  opening.style.display="none";
  slide.style.display="flex";
  next();
},{once:true});
</script>

</body>
</html>
